import{S as B,i as D,s as M,F as N,d as J,t as R,a as T,m as j,c as z,J as O,f as I,h as b,j as Q,k as K,l as g,n as c,o as A,E as U,q as V,G as X,u as _,A as q,v as k,w as f,p as L,K as Y,r as Z,I as y,z as P}from"./index-D49pSSYG.js";function W(o){let e,i;return{c(){e=_("strong"),i=q(o[3]),f(e,"class","txt-nowrap")},m(s,l){g(s,e,l),c(e,i)},p(s,l){l&8&&y(i,s[3])},d(s){s&&b(e)}}}function x(o){let e,i,s,l,t,r,p,d;return{c(){e=_("label"),i=q("新密码"),l=k(),t=_("input"),f(e,"for",s=o[8]),f(t,"type","password"),f(t,"id",r=o[8]),t.required=!0,t.autofocus=!0},m(u,n){g(u,e,n),c(e,i),g(u,l,n),g(u,t,n),P(t,o[0]),t.focus(),p||(d=A(t,"input",o[6]),p=!0)},p(u,n){n&256&&s!==(s=u[8])&&f(e,"for",s),n&256&&r!==(r=u[8])&&f(t,"id",r),n&1&&t.value!==u[0]&&P(t,u[0])},d(u){u&&(b(e),b(l),b(t)),p=!1,d()}}}function ee(o){let e,i,s,l,t,r,p,d;return{c(){e=_("label"),i=q("确认新密码"),l=k(),t=_("input"),f(e,"for",s=o[8]),f(t,"type","password"),f(t,"id",r=o[8]),t.required=!0},m(u,n){g(u,e,n),c(e,i),g(u,l,n),g(u,t,n),P(t,o[1]),p||(d=A(t,"input",o[7]),p=!0)},p(u,n){n&256&&s!==(s=u[8])&&f(e,"for",s),n&256&&r!==(r=u[8])&&f(t,"id",r),n&2&&t.value!==u[1]&&P(t,u[1])},d(u){u&&(b(e),b(l),b(t)),p=!1,d()}}}function te(o){let e,i,s,l,t,r,p,d,u,n,w,S,C,v,h,F,E,m=o[3]&&W(o);return r=new I({props:{class:"form-field required",name:"password",$$slots:{default:[x,({uniqueId:a})=>({8:a}),({uniqueId:a})=>a?256:0]},$$scope:{ctx:o}}}),d=new I({props:{class:"form-field required",name:"passwordConfirm",$$slots:{default:[ee,({uniqueId:a})=>({8:a}),({uniqueId:a})=>a?256:0]},$$scope:{ctx:o}}}),{c(){e=_("form"),i=_("div"),s=_("h4"),l=q(`重置超级用户密码\r
                `),m&&m.c(),t=k(),z(r.$$.fragment),p=k(),z(d.$$.fragment),u=k(),n=_("button"),w=_("span"),w.textContent="设置新密码",S=k(),C=_("div"),v=_("a"),v.textContent="返回登录",f(s,"class","m-b-xs"),f(i,"class","content txt-center m-b-sm"),f(w,"class","txt"),f(n,"type","submit"),f(n,"class","btn btn-lg btn-block"),n.disabled=o[2],K(n,"btn-loading",o[2]),f(e,"class","m-b-base"),f(v,"href","/login"),f(v,"class","link-hint"),f(C,"class","content txt-center")},m(a,$){g(a,e,$),c(e,i),c(i,s),c(s,l),m&&m.m(s,null),c(e,t),j(r,e,null),c(e,p),j(d,e,null),c(e,u),c(e,n),c(n,w),g(a,S,$),g(a,C,$),c(C,v),h=!0,F||(E=[A(e,"submit",V(o[4])),U(X.call(null,v))],F=!0)},p(a,$){a[3]?m?m.p(a,$):(m=W(a),m.c(),m.m(s,null)):m&&(m.d(1),m=null);const G={};$&769&&(G.$$scope={dirty:$,ctx:a}),r.$set(G);const H={};$&770&&(H.$$scope={dirty:$,ctx:a}),d.$set(H),(!h||$&4)&&(n.disabled=a[2]),(!h||$&4)&&K(n,"btn-loading",a[2])},i(a){h||(T(r.$$.fragment,a),T(d.$$.fragment,a),h=!0)},o(a){R(r.$$.fragment,a),R(d.$$.fragment,a),h=!1},d(a){a&&(b(e),b(S),b(C)),m&&m.d(),J(r),J(d),F=!1,Q(E)}}}function se(o){let e,i;return e=new N({props:{$$slots:{default:[te]},$$scope:{ctx:o}}}),{c(){z(e.$$.fragment)},m(s,l){j(e,s,l),i=!0},p(s,[l]){const t={};l&527&&(t.$$scope={dirty:l,ctx:s}),e.$set(t)},i(s){i||(T(e.$$.fragment,s),i=!0)},o(s){R(e.$$.fragment,s),i=!1},d(s){J(e,s)}}}function le(o,e,i){let s,{params:l}=e,t="",r="",p=!1;async function d(){if(!p){i(2,p=!0);try{await L.collection("_superusers").confirmPasswordReset(l==null?void 0:l.token,t,r),Y("已成功设置新的超级用户密码。"),Z("/")}catch(w){L.error(w)}i(2,p=!1)}}function u(){t=this.value,i(0,t)}function n(){r=this.value,i(1,r)}return o.$$set=w=>{"params"in w&&i(5,l=w.params)},o.$$.update=()=>{o.$$.dirty&32&&i(3,s=O.getJWTPayload(l==null?void 0:l.token).email||"")},[t,r,p,s,d,l,u,n]}class ae extends B{constructor(e){super(),D(this,e,le,se,M,{params:5})}}export{ae as default};
